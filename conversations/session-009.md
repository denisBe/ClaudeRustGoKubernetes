# Session 9 — Fix setup-linux.sh and WSL Environment Setup

**Date:** 2026-02-16
**Commit:** aa09600

## Summary

Denis switched to WSL and ran the Linux setup script, which failed with tar errors during Go installation. Claude diagnosed and fixed three issues in the script, and helped configure sudo for passwordless access.

## What was done

- **scripts/setup-linux.sh** — Three fixes:
  - Added root/sudo check at script start with clear error message
  - Added `rm -f /tmp/go.tar.gz` before downloading Go (stale file from previous run caused permission denied)
  - Added `minikube delete` before `minikube start` (stale certificates from previous setup)
- Configured passwordless sudo for WSL dev environment
- Imported existing MEMORY.md into Claude Code's project memory system
- Set up git identity (`user.name`, `user.email`) on WSL

## Key decisions

- `NOPASSWD: ALL` is acceptable for a local WSL dev machine
- `minikube delete` before start ensures clean state on setup re-runs
- Claude Code's auto memory directory uses path-based naming (leading dash from `/` → `-`)

## Full Transcript

> I already have a MEMORY.md file for this project from an other setup. How can I import it?

Claude explained the auto memory directory path (`/home/denis/.claude/projects/-home-denis-ClaudeRustGoKubernetes/memory/`) and provided the `cp` command.

> why does the project folder starts with a - ? It's causing issues with the commandline. Is it possible to remove the first - ?

Claude explained it's auto-generated by Claude Code (path with `/` replaced by `-`), can't be changed, and suggested using full absolute paths or `./` prefix as workarounds.

> I've imported the MEMORY.md file. Can you use it?

[Read MEMORY.md — confirmed contents: user info, conversation logging rules, project direction, environment notes]

Claude confirmed the memory file was loaded and summarized its contents.

> The script "setup-linux.sh" is not working. It failed after a lot of tar error when trying to install go. Can you run it and see what's wrong?

[Read scripts/setup-linux.sh]
[Attempted to run with sudo — failed: "a terminal is required to read the password"]

Claude identified that sudo requires a password and can't run non-interactively.

> How can I make you able to execute sudo commands?

Claude explained adding `NOPASSWD: ALL` to sudoers via `visudo`.

> I've updated the right for sudo. Can you try to run the setup-linux.sh script again and see what's wrong?

[Ran sudo bash setup-linux.sh — failed at `/tmp/go.tar.gz: Permission denied`]
[Checked: stale file owned by denis from July 2024]
[Fixed: added `rm -f /tmp/go.tar.gz` before wget]
[Re-ran script — Go, Rust, kubectl, minikube installed successfully, but minikube start failed with x509 certificate error]

Claude diagnosed two issues: stale `/tmp/go.tar.gz` and corrupt minikube certificates. Fixed the Go issue in the script and suggested `minikube delete` for the cert issue.

> I ran the command manually it's now working. Yes please update the script

[Edited setup-linux.sh: added `minikube delete` before `minikube start`]

> It seems that the scripts needs to run with sudo. Can you add a check at the beginning of the script with an error message if it's not executed with sudo?

[Edited setup-linux.sh: added root check with `id -u` at script start]

> commit this

[Committed as aa09600: "Fix setup-linux.sh: stale files, certs, and root check"]
[Git identity was not configured — Denis set it up manually, then commit succeeded]

> You forgot to add a session markdown file and update the summary.md

Claude created session-009.md and updated SUMMARY.md.
